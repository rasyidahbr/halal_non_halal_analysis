function appended(t,a,e,l){var n="<tr id='row"+l+"' class='rows'><td valign='middle'><span id='lblNisabYear"+l+"'>"+(t+(l-1))+"</span></td><td valign='middle'>$<span id='lblNisab"+l+"'>"+nisabvalue+"</span></td><td> $<input name='txtBalance"+l+"' type='text' value='0' id='txtBalance"+l+"' onblur='isFieldEmpty(this)' onkeyup='calTMValueSavingBackdates(this)' class='sb'></td><td>$<input name='txtInterest"+l+"' type='text' value='0' id='txtInterest"+l+"' onblur='isFieldEmpty(this)' onkeyup='calTMValueSavingBackdates(this)' class='sb'></td><td><span id='lblLB"+l+"'></span></td><td><span id='lblZDue"+l+"'></span></td></tr>";console.log(n),$("#theTable tbody").append(n)}function sortTable(){for(var t=document.getElementById("theTable").tBodies[0],a=[],e=0,l=t.rows.length;l>e;e++)if(e>0){var n=t.rows[e],c=parseFloat(n.cells[0].textContent||n.cells[0].innerText);isNaN(c)||a.push([c,n])}a.sort(function(t,a){return t[0]-a[0]});for(var e=0,l=a.length;l>e;e++)t.appendChild(a[e][1]);a=null}function getcurrentNisab(t,a){getNisab(t,a).done(function(t){return t})}function InitializeSavingsMultiAccountDatePicker(){$(document).ready(function(){$("#txtHaulStart, #txtHaulEnd").datepicker({dateFormat:"dd-mm-yy",showOn:"button",buttonImage:"/images/zakat/calendar-icon.png",buttonImageOnly:!0,changeYear:!0,changeMonth:!0,yearRange:"1970:c"}),$("#txtHaulEnd").on("change",function(){var t=$("#txtHaulEnd").datepicker("getDate"),a=t.getMonth()+1,e=t.getFullYear();getNisab(a,e).done(function(t){$("#lblNisab").text(t)})}),$("#txtHaulStart, #txtHaulEnd").on("change",function(){var t=$("#txtHaulStart").datepicker("getDate"),a=$("#txtHaulEnd").datepicker("getDate"),e=t.getMonth()+1,l=a.getMonth()+1,n=t.getFullYear(),c=a.getFullYear(),o=12*(c-n)+(l-e)+1;if(console.log(o),t>a)return alert("Haul End Date should be later than Haul Start Date "),!1;if(o>13)return alert("You can only select maximum 13 months"),!1;$("#tblShare tbody tr").remove();var i=0;i=c-n==0?l-e+1:12-e+l+1;for(var s=n,r=e-1,u=0;i>u;u++){var d="<tr id='row"+(u+1)+"'><td><span class='lblMonthYear'>"+monthNames[r+u]+" "+s+"</span></td><td><input type='text' value='0' onBlur='isFieldEmpty(this)' onKeyUp='calculateLowest(this)' class='txtAccount1' /></td><td><input type='text' value='0' onBlur='isFieldEmpty(this)' onKeyUp='calculateLowest(this)' class='txtAccount2'/></td><td><input type='text' value='0' onBlur='isFieldEmpty(this)' onKeyUp='calculateLowest(this)' class='txtAccount3'/></td><td><input type='text' value='0' onBlur='isFieldEmpty(this)' onKeyUp='calculateLowest(this)' class='txtAccount4'/></td><td><input type='text' value='0' onBlur='isFieldEmpty(this)' onKeyUp='calculateLowest(this)' class='txtAccount5'/></td><td>$ <span class='lblTLBalance'>0</span></td></tr>";$("#tblShare tbody").append(d),e+u==12&&(s++,r=-u-1)}setupAccount()});var t=new Date,a=("0"+t.getDate().toString()).substr(-2)+"-"+("0"+(t.getMonth()+1).toString()).substr(-2)+"-"+t.getFullYear().toString();$("#txtHaulEnd").val(a);var e=$("#txtHaulEnd").datepicker("getDate"),l=e.getMonth()+1,n=e.getFullYear();getNisab(l,n).done(function(t){$("#lblNisab").text(t)})})}function calculateZakatSavings(){var t=parseFloat($("#txtBalance").val())-parseFloat($("#txtInterest").val());t>=parseInt($("#lblNisab").html())?($("#lblZDue").html("$ "+(Math.ceil(t/100*2.5*100)/100).toFixed(parseInt(2))),$("#lblZDue").html(addCommas($("#lblZDue").html()))):$("#lblZDue").html("No Zakat Due")}function clearAllSavings(){$("#txtBalance").val("0"),$("#lblZDue").html(""),$("#txtInterest").val("0"),$("#btnSetNisab").click()}function calTMValueSavingBackdates(t){var a=$(t).parents("tr.rows").attr("id").substr(3),e=$("#txtBalance"+a),l=$("#txtInterest"+a),n=$("#lblLB"+a),c=$("#lblNisab"+a),o=$("#lblZDue"+a),i=$(t);isNaN(i.val())&&(i.val(i.val().substring(0,i.val().length-1)),alert("Enter Numeric Values only")),isNaN(parseFloat(e.val())-parseFloat(l.val()))?o.text("No Zakat Due"):(n.html(parseFloat(e.val())-parseFloat(l.val())),parseFloat(n.html())>=parseInt(c.html())?o.text((parseFloat(n.html())/100*2.5).toFixed(parseInt(2))):o.text("No Zakat Due"))}function calculateZakatSavingBackdates(){for(var t=parseInt($("#ddlHEYear").val())-parseInt($("#ddlHSYear").val()),a=0,e=0;t>=e;e++){var l;l=isNaN(parseFloat($("#lblZDue"+(e+1)).text()))?0:parseFloat($("#lblZDue"+(e+1)).text()),a=l+a}$("#lblZDue").html("$ "+a.toFixed(parseInt(2))),$("#lblZDue").html(addCommas($("#lblZDue").html()))}function clearAllSavingBackdates(){$("#lblZDue").html(""),$("#ddlHSYear").val("1970"),$("#ddlHEYear").val((new Date).getFullYear()-1),$("#GridView1").hide()}function calculateZakatMultipleSavings(){var t=parseInt($(".lblTLBalance:eq(0)").text());console.log(t),$(".lblTLBalance").each(function(){console.log(parseInt($(this).text())),parseInt($(this).text())<=t&&(t=$(this).text())}),t>=parseInt($("#lblNisab").html())?($("#lblZDue").html("$ "+(Math.ceil(t/100*2.5*100)/100).toFixed(parseInt(2))),$("#lblZDue").html(addCommas($("#lblZDue").html()))):$("#lblZDue").html("No Zakat Due")}function clearAllMultipleSavings(){$("#txtHaulStart, #txtHaulEnd").val(""),$("#tblShare tbody tr").remove(),$("#txtName").val(""),$("#txtName2").val(""),$("#txtName3").val(""),$("#txtName4").val(""),$("#txtName5").val(""),$("#ddlNOAccount").val("2"),$("#lblZDue").html(""),$("#btnSetNisab").click()}function setupAccount(){for(var t=parseInt($("#ddlNOAccount").val()),a=0;6>a;a++){var e=document.getElementById("acc"+a);$(e).hide(),t>=a&&$(e).show()}$("#tblShare td:nth-child(n+2):nth-child(-n+6), #tblShare th:nth-child(n+2):nth-child(-n+6)").hide(),$("#tblShare td:nth-child(n+2):nth-child(-n+"+(t+1)+"), #tblShare th:nth-child(n+2):nth-child(-n+"+(t+1)+")").show()}function calculateLowest(t){if(isNaN($(t).val()))return $(t).val($(t).val().substring(0,$(t).val().length-1)),alert("Enter Numeric Values only"),!1;var a=$(t).parent().parent(),e=0;$("input",a).each(function(){return isNaN($(this).val())?!1:void(e+=parseInt($(this).val()))}),$(".lblTLBalance",a).text(e)}var monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nisabvalue;$("select#ddlSavings").val("SingleAccount").trigger("change"),$("#acc3,#acc4,#acc5").hide(),$("#tblShare td:nth-child(n+2):nth-child(-n+6), #tblShare th:nth-child(n+2):nth-child(-n+6)").hide(),$("#tblShare td:nth-child(n+2):nth-child(-n+3), #tblShare th:nth-child(n+2):nth-child(-n+3)").show(),$(document).on("keyup","#txtName",function(){$("#lblHeader2").html("Lowest Balance for Account "+$("#txtName").val())}),$(document).on("keyup","#txtName2",function(){$("#lblHeader3").html("Lowest Balance for Account "+$("#txtName2").val())}),$(document).on("keyup","#txtName3",function(){$("#lblHeader4").html("Lowest Balance for Account "+$("#txtName3").val())}),$(document).on("keyup","#txtName4",function(){$("#lblHeader5").html("Lowest Balance for Account "+$("#txtName4").val())}),$(document).on("keyup","#txtName5",function(){$("#lblHeader6").html("Lowest Balance for Account "+$("#txtName5").val())}),$(document).on("change","#ddlNOAccount",function(){setupAccount()}),$(document).on("click","#submitThis",function(){a=parseFloat($("#ddlHSYear").val()),b=parseFloat($("#ddlHEYear").val()),c=b-a;var t=c+1,e=0;if(c>0){$("#theTable tbody").find("tr:gt(0)").remove();for(var l=1;l<=c+1;l++)!function(l){getNisab("0",a+(l-1),!0).done(function(n){nisabvalue=n,appended(a,b,c,l),++e==t&&sortTable()})}(l)}});